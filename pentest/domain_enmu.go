package pentest

import "fmt"

// Domain Enumeration
func SubdomainEnumeration(target string, ignoring bool) bool {
	if !ignoring {
		return false
	}

	fmt.Println("Ignoring non 200 HTTP Response of the target.")

	foundOrNot := false

	payload, payloaderror := ReadPayload("penetrationtesting/payload/subdomain.txt")
	if payloaderror != nil {
		fmt.Printf("Error reading payload file: %s\n", payloaderror)
	}

	for _, trial := range payload {
		Domain := "https:" + trial + "." + target
		if SendingRequest(Domain) {
			foundOrNot = true
			fmt.Printf("Attack Success: %s\n", Domain)
			// NmapExecution(passing.Plan.Target, trial+"."+target)
		}
	}

	if !foundOrNot {
		fmt.Printf("ðŸ”º No Subdomain Found")
	}

	fmt.Println("ðŸŸ¢ Subdomain Found")
	return foundOrNot
}
