package pentest

import "fmt"

func GenericSQLInjection(target string) bool {

	foundOrNot := false
	fmt.Println("Start Generic SQL Injection")
	payload, payloaderror := ReadPayload("pentest/payload/SQL/genericSQL.txt")
	if payloaderror != nil {
		fmt.Printf("Error reading payload file: %s\n", payloaderror)
	}

	for _, trial := range payload {
		URL := target + trial
		if SendingRequest(URL) {
			foundOrNot = true
			fmt.Printf("Attack Success: %s\n", URL)
		}
	}

	return foundOrNot
}
